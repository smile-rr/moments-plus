---
import { SUPPORTED_LOCALES, type Locale, getLocaleName, getLocalizedPath } from '../i18n';

interface Props {
  currentLang: Locale;
  currentPath: string;
}

const { currentLang, currentPath } = Astro.props;

// 从当前路径中移除语言前缀
let pathWithoutLang = currentPath;
SUPPORTED_LOCALES.forEach(loc => {
  if (currentPath.startsWith(`/${loc}`)) {
    pathWithoutLang = currentPath.replace(`/${loc}`, '') || '/';
  }
});
---

<div class="flex items-center gap-3">
  {SUPPORTED_LOCALES.map((loc) => (
    <a 
      href={getLocalizedPath(loc, pathWithoutLang)}
      class={`text-sm transition-all hover:opacity-100 ${loc === currentLang ? 'opacity-100 font-medium text-[#1d1d1f]' : 'opacity-40 text-[#86868b] hover:opacity-60'}`}
      hreflang={loc}
      aria-label={`Switch to ${getLocaleName(loc)}`}
    >
      {getLocaleName(loc)}
    </a>
  ))}
</div><style>
  a {
    position: relative;
    padding: 2px 0;
  }
  
  a.active::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 1px;
    background: currentColor;
  }
</style>
