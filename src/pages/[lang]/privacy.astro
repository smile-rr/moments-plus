---
import LegalLayout from '../../layouts/LegalLayout.astro';
import { SUPPORTED_LOCALES, type Locale } from '../../i18n';
import { getPrivacyContent } from '../../utils/content';

export async function getStaticPaths() {
  // 只为非默认语言生成路径
  return SUPPORTED_LOCALES
    .filter(lang => lang !== 'en')
    .map((lang) => ({
      params: { lang },
    }));
}

const { lang } = Astro.params as { lang: Locale };
const privacyContent = await getPrivacyContent(lang);

if (!privacyContent) {
  return Astro.redirect('/en/privacy');
}

const { data, render } = privacyContent;
const { Content } = await render();
const currentPath = `/${lang}/privacy`;
---

<LegalLayout 
  title={data.title} 
  description={data.title}
  lang={lang}
  currentPath={currentPath}
  lastUpdated={data.lastUpdated}
>
  <Content />
</LegalLayout>
