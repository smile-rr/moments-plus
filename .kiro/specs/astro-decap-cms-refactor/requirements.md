# 需求文档

## 简介

本文档定义了将 Moments+ iOS 应用支持网站从纯 HTML/CSS 架构重构为基于 Astro 和 Decap CMS 的现代化静态站点的需求。该重构旨在提供内容管理能力，同时保持多语言支持和 GitHub Pages 部署方式。

## 术语表

- **System**: Moments+ 网站系统
- **Astro**: 现代静态站点生成器框架
- **Decap_CMS**: 基于 Git 的内容管理系统（原 Netlify CMS）
- **Content_Editor**: 通过 CMS 界面编辑内容的用户
- **Visitor**: 访问网站的普通用户
- **i18n_System**: 国际化系统，负责多语言内容管理
- **Git_Gateway**: 用于 CMS 认证的 Git 网关服务
- **GitHub_Pages**: GitHub 提供的静态网站托管服务
- **Collection**: Decap CMS 中的内容集合，对应不同类型的页面或内容
- **Locale**: 语言区域设置（en, zh, ja）
- **Content_Model**: 内容数据结构定义

## 需求

### 需求 1: 静态站点生成

**用户故事:** 作为开发者，我希望使用 Astro 作为静态站点生成器，以便获得现代化的开发体验和优化的性能。

#### 验收标准

1. 系统使用 Astro 4.x 作为静态站点生成框架
2. 构建过程生成纯静态 HTML/CSS/JS 文件
3. 支持组件化开发模式
4. 构建时自动优化资源（CSS、JavaScript、图片）
5. 生成的文件结构符合 GitHub Pages 部署要求

### 需求 2: 内容管理系统集成

**用户故事:** 作为内容编辑者，我希望通过可视化界面管理网站内容，而不需要直接编辑代码文件。

#### 验收标准

1. 系统集成 Decap CMS 作为内容管理系统
2. 访问 /admin 路径时显示 CMS 管理界面
3. 使用 Git Gateway 或 GitHub OAuth 进行 CMS 用户认证
4. 内容保存时自动提交更改到 Git 仓库
5. 支持通过 CMS 界面编辑所有页面内容
6. 为不同内容类型定义清晰的 Collection 结构

### 需求 3: 多语言支持

**用户故事:** 作为访问者，我希望能够以我的首选语言（英文、中文或日文）浏览网站内容。

#### 验收标准

1. 系统支持三种语言：英文（en）、简体中文（zh）、日文（ja）
2. 根据浏览器语言偏好自动显示对应语言版本
3. 每种语言有独立的 URL 路径（如 /en/, /zh/, /ja/）
4. 切换语言时导航到相同页面的对应语言版本
5. 每个页面提供语言切换器组件
6. i18n 系统管理所有 UI 文本的翻译
7. 通过 Decap CMS 管理每种语言的内容

### 需求 4: 页面结构保持

**用户故事:** 作为项目负责人，我希望重构后的网站保持现有的页面结构和功能，确保用户体验的连续性。

#### 验收标准

1. 包含主页，展示应用介绍、功能特性和截图
2. 包含支持页面，提供用户支持信息
3. 包含隐私政策页面
4. 包含使用条款页面
5. 所有页面显示与原网站相同的内容结构
6. 保持原有的视觉设计和布局
7. 保持所有现有功能（如导航、链接、图片展示）

### 需求 5: 内容模型定义

**用户故事:** 作为开发者，我希望为不同类型的内容定义清晰的数据结构，以便在 CMS 中进行管理。

#### 验收标准

1. 为主页内容定义数据模型（hero section、功能列表、截图）
2. 为支持页面定义数据模型
3. 为法律页面（隐私政策、使用条款）定义数据模型
4. 为全局配置（网站标题、描述、社交链接）定义数据模型
5. CMS 编辑界面根据数据模型提供相应的表单字段
6. 每个数据模型支持多语言字段

### 需求 6: CMS 配置

**用户故事:** 作为开发者，我希望配置 Decap CMS 以支持项目的特定需求和工作流程。

#### 验收标准

1. 在 public/admin/config.yml 中定义 CMS 配置
2. 配置 GitHub 后端用于内容存储
3. 定义所有 Collection 的字段和验证规则
4. 配置媒体文件存储路径（images/）
5. 为每个 Collection 配置预览模板
6. 配置编辑工作流（可选：草稿、审核、发布）

### 需求 7: 响应式设计

**用户故事:** 作为移动设备用户，我希望网站在不同屏幕尺寸上都能良好显示。

#### 验收标准

1. 在桌面设备（>1024px）上正确显示
2. 在平板设备（768px-1024px）上正确显示
3. 在移动设备（<768px）上正确显示
4. 调整浏览器窗口大小时自适应布局
5. 在移动设备上提供触摸友好的交互元素

### 需求 8: SEO 优化

**用户故事:** 作为网站所有者，我希望网站对搜索引擎友好，以提高可发现性。

#### 验收标准

1. 为每个页面生成适当的 meta 标签（title、description）
2. 生成语义化的 HTML 结构
3. 为每种语言生成 hreflang 标签
4. 生成 sitemap.xml 文件
5. 生成 robots.txt 文件
6. 为图片添加 alt 属性
7. 使用适当的标题层级（h1-h6）

### 需求 9: GitHub Pages 部署

**用户故事:** 作为开发者，我希望通过 GitHub Actions 自动构建和部署网站到 GitHub Pages。

#### 验收标准

1. 使用 GitHub Actions 进行自动化构建
2. 代码推送到主分支时自动触发构建流程
3. 将构建产物部署到 GitHub Pages
4. 配置正确的 base URL 用于 GitHub Pages
5. 部署完成后更新的内容在网站上可访问
6. 构建失败时提供清晰的错误信息

### 需求 10: 资源管理

**用户故事:** 作为内容编辑者，我希望能够通过 CMS 上传和管理图片等媒体资源。

#### 验收标准

1. 支持通过 CMS 界面上传图片
2. 上传的图片存储到 images/ 目录
3. CMS 中提供媒体库浏览功能
4. 支持常见图片格式（PNG、JPG、WebP）
5. 构建时自动优化图片大小和格式
6. 保持现有的应用图标和截图资源

### 需求 11: 开发体验

**用户故事:** 作为开发者，我希望有良好的本地开发体验，包括热重载和清晰的错误提示。

#### 验收标准

1. 提供本地开发服务器
2. 文件更改时自动重新加载页面
3. 开发模式下提供详细的错误信息
4. 提供清晰的项目文档（README）
5. 使用 package.json 管理依赖和脚本
6. 提供一键启动的开发命令

### 需求 12: 内容迁移

**用户故事:** 作为开发者，我希望将现有 HTML 文件中的内容迁移到新的 CMS 结构中。

#### 验收标准

1. 从现有 HTML 文件中提取内容
2. 将提取的内容转换为 Markdown 或 JSON 格式
3. 为每种语言创建对应的内容文件
4. 保持内容的语义和结构
5. 迁移完成后所有内容在新网站上正确显示

### 需求 13: 样式系统

**用户故事:** 作为开发者，我希望有组织良好的样式系统，便于维护和扩展。

#### 验收标准

1. 使用现代 CSS 方法（CSS Modules 或 Scoped Styles）
2. 保持现有的视觉设计风格
3. 组织样式为可复用的组件样式
4. 定义全局样式变量（颜色、字体、间距）
5. 构建时自动优化和压缩 CSS

### 需求 14: 错误处理

**用户故事:** 作为访问者，当访问不存在的页面时，我希望看到友好的错误提示。

#### 验收标准

1. 访问不存在的页面时显示 404 错误页面
2. 为每种语言提供本地化的 404 页面
3. 404 页面提供返回主页的链接
4. 404 页面保持网站的整体设计风格

### 需求 15: 性能优化

**用户故事:** 作为访问者，我希望网站加载快速，提供流畅的浏览体验。

#### 验收标准

1. 实现代码分割以减少初始加载时间
2. 延迟加载非关键资源
3. 优化图片加载（懒加载、响应式图片）
4. 最小化 CSS 和 JavaScript 文件
5. 生成高效的静态 HTML
6. 页面首次内容绘制在 3 秒内完成
